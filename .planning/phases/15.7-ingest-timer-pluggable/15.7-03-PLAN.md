---
phase: 15.7-ingest-timer-pluggable
plan: 03
type: execute
wave: 3
depends_on: ["15.7-01", "15.7-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Timer de ingest funciona en sandbox con los 5 niveles"
    - "Cada nivel ejecuta su accion correspondiente"
    - "Presets controlan los tiempos reales del timer"
    - "5 sliders independientes ajustan cada nivel"
    - "Countdown numerico visible mostrando tiempo restante y nivel actual"
    - "Datos nuevos re-evaluan el nivel; preguntas no interrumpen"
  artifacts: []
  key_links: []
---

<objective>
Verify all 6 success criteria from Phase 15.7 are met through hands-on testing in the sandbox.

Purpose: Confirm the timer implementation works end-to-end as specified before marking the phase complete.

Output: Verification report confirming all success criteria pass or listing specific issues to fix.
</objective>

<execution_context>
@/home/jose147/.claude/get-shit-done/workflows/execute-plan.md
@/home/jose147/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15.7-ingest-timer-pluggable/15.7-CONTEXT.md
@.planning/phases/15.7-ingest-timer-pluggable/15.7-01-SUMMARY.md
@.planning/phases/15.7-ingest-timer-pluggable/15.7-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Start server and verify TypeScript compilation</name>
  <files></files>
  <action>
1. Kill any existing dev server: `pkill -f "next dev" 2>/dev/null`
2. Run `npx tsc --noEmit` from the project root to verify no type errors
3. Start the dev server: `cd morfx && npm run dev` (or from project root if that's the setup)
4. Wait for server to be ready on port 3020
5. Report any compilation errors
  </action>
  <verify>
`npx tsc --noEmit` exits with code 0. Dev server starts successfully on port 3020.
  </verify>
  <done>
No TypeScript errors. Server running on port 3020.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete ingest timer simulation in sandbox with 5 levels, presets, sliders, countdown, and timer-triggered messages.
  </what-built>
  <how-to-verify>
Visit http://localhost:3020/sandbox and test the following scenarios:

**Test 1: Timer Toggle and Countdown (SC #5)**
1. Open the Ingest tab in the debug panel (click "Ingest" tab)
2. Enable the timer toggle (should see "Timer Simulacion" with ON/OFF toggle)
3. Verify the timer is OFF by default and can be toggled ON

**Test 2: Timer Starts on First Data (SC #1, #6)**
1. With timer enabled, type: "Hola, soy Jose Rodriguez"
2. The message should be classified as datos/mixto
3. Timer countdown should appear in the Status grid showing remaining time and level
4. Expected: Level 1 "Datos parciales" with ~6min countdown (if Real preset)
5. Type a question: "Cuanto cuesta?" - timer should NOT be interrupted (still counting)

**Test 3: Presets Control Real Times (SC #3)**
1. Change preset to "Instantaneo"
2. Timer should restart with ~2 second duration
3. Wait for timer to expire - a message should appear in chat

**Test 4: Level Actions (SC #2)**
1. Start a new session, enable timer, set preset to "Instantaneo"
2. Type: "Hola" (entering collecting_data)
3. Wait for Level 0 timer to fire - should see "Quedamos pendientes a tus datos..."
4. Type: "Jose Rodriguez, 3101234567, Calle 80 #20-30"
5. Wait for Level 1 timer - should see "Para poder despachar tu producto nos faltaria:..."
6. Type enough data to complete 6 fields (add ciudad, departamento)
7. Level 2 should fire silently (no message) and chain to Level 3

**Test 5: 5 Independent Sliders (SC #4)**
1. Change any individual slider - verify it moves independently
2. Moving a slider should de-select the active preset (if values no longer match)
3. Selecting a preset should set all 5 sliders to preset values

**Test 6: Session Reset**
1. With timer running, click "Nueva Sesion"
2. Timer should stop, countdown should disappear
3. Timer toggle should be OFF

**Test 7: Pause/Resume**
1. Start timer, click pause button next to countdown
2. Countdown should freeze
3. Click resume, countdown should continue
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe specific issues found</resume-signal>
</task>

</tasks>

<verification>
All 6 Phase 15.7 success criteria verified by human:
1. Timer de ingest funciona en sandbox con los 5 niveles
2. Cada nivel ejecuta su accion correspondiente
3. Presets (Real/Rapido/Instantaneo) controlan los tiempos reales
4. 5 sliders independientes permiten ajustar cada nivel
5. Countdown numerico visible mostrando tiempo restante y nivel actual
6. Datos nuevos re-evaluan el nivel; preguntas no interrumpen
</verification>

<success_criteria>
All tests in human-verify checkpoint pass without issues.
</success_criteria>

<output>
After completion, create `.planning/phases/15.7-ingest-timer-pluggable/15.7-03-SUMMARY.md`
</output>
