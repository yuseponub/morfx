# Phase 9.1: Order States Config - Context

**Gathered:** 2026-02-03
**Status:** Ready for planning

<domain>
## Phase Boundary

Configuración de estados de pedido a nivel workspace que reemplazan el mapeo hardcodeado actual. Los estados tienen nombre, emoji, y orden configurable. Cada estado agrupa uno o más stages de cualquier pipeline del workspace. El emoji del estado se muestra como indicador visual en la lista de conversaciones de WhatsApp.

**Fuera de scope:**
- Guía de comportamiento para agente IA (se configura en otra fase)
- Estados predeterminados (el admin crea todos desde cero)
- Distinción ganado/perdido/pendiente (el sistema no infiere resultado)

</domain>

<decisions>
## Implementation Decisions

### Definición de estados
- Sin estados predeterminados — el admin crea todos los estados desde cero
- Cada estado tiene: nombre y emoji (obligatorios)
- No se requiere indicador de "resultado final" (is_closed) — el sistema no distingue
- Lista vertical reordenable con drag-and-drop

### Asignación stage→estado
- Al editar un estado, el admin selecciona qué stages pertenecen a él
- Un stage puede pertenecer a máximo un estado (relación N:1)
- Stages no asignados = sin indicador en WhatsApp
- Estados compartidos entre todos los pipelines del workspace

### Emoji e indicador
- Picker visual de emojis (como en el chat)
- Indicador en WhatsApp: emoji sobre el avatar del contacto, esquina superior derecha (estilo Callbell)
- Preview en vivo mientras el admin configura — mostrar cómo queda el emoji sobre un avatar de ejemplo

### Claude's Discretion
- Diseño del formulario de creación/edición de estados
- Cómo mostrar los stages disponibles en el selector
- Validaciones y límites (max caracteres nombre, etc.)

</decisions>

<specifics>
## Specific Ideas

- "Me gusta cómo hace Callbell — emoji en la esquina superior derecha del avatar"
- Ver screenshot de referencia: Callbell muestra avatar + badge de canal + emoji de estado
- La lista de estados debe ser vertical y reordenable con drag-and-drop

</specifics>

<deferred>
## Deferred Ideas

- Guía de comportamiento para agente conversacional — se configura directamente en la guía del agente, no en los estados

</deferred>

---

*Phase: 09.1-order-states-config*
*Context gathered: 2026-02-03*
